<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>第7課：單字朗讀練習</title>
  <style>
    body {
      font-family: 'Arial', 'Hiragino Kaku Gothic ProN', '游ゴシック', sans-serif;
      background-color: #fff0f5;
      color: #333;
      padding: 2rem;
    }
    h1 {
      text-align: center;
      color: #d26fa0;
      font-size: 2rem;
      margin-bottom: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 0 12px #e3a5c7;
    }
    th, td {
      padding: 0.8rem;
      text-align: left;
      border-bottom: 1px solid #f0cde3;
    }
    th {
      background-color: #f8d8e9;
      color: #c04583;
    }
    td.jp:hover, td.cn:hover {
      cursor: pointer;
      background-color: #ffeaf5;
      transition: background-color 0.3s, transform 0.2s;
      transform: scale(1.02);
    }
    .autoplay-btn {
      background-color: #d26fa0;
      color: white;
      padding: 0.8rem 1.5rem;
      border-radius: 20px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: background-color 0.3s;
    }
    .autoplay-btn:hover {
      background-color: #c04583;
    }
  </style>
</head>
<body>
  <h1>📘 第7課：單字＋例句朗讀練習</h1>

  <button id="autoplay-btn" class="autoplay-btn">🔊 自動播放</button>

  <table>
    <tr>
      <th>單字（日文）</th>
      <th>中文意思</th>
      <th>例句（日文）</th>
      <th>中文翻譯</th>
    </tr>
    <tr><td class="jp">きります（切ります）</td><td class="cn">剪、切</td><td class="jp">はさみで かみを きります。</td><td class="cn">用剪刀剪紙。</td></tr>
    <tr><td class="jp">おくります（送ります）</td><td class="cn">寄、送</td><td class="jp">ともだちに プレゼントを おくります。</td><td class="cn">送禮物給朋友。</td></tr>
    <tr><td class="jp">あげます</td><td class="cn">給</td><td class="jp">せんせいに おかしを あげます。</td><td class="cn">給老師點心。</td></tr>
    <tr><td class="jp">もらいます</td><td class="cn">得到</td><td class="jp">ともだちに はなを もらいます。</td><td class="cn">收到朋友送的花。</td></tr>
    <tr><td class="jp">かします（貸します）</td><td class="cn">借給</td><td class="jp">ともだちに おかねを かします。</td><td class="cn">借錢給朋友。</td></tr>
  </table>

  <script>
    let voicesLoaded = false;
    let jpVoice = null;
    let cnVoice = null;
    let autoPlay = false;
    let currentIndex = 0;
    let vocabRows = [];

    function initVoices() {
      const voices = speechSynthesis.getVoices();
      jpVoice = voices.find(voice => voice.lang === 'ja-JP');
      cnVoice = voices.find(voice => voice.lang === 'zh-CN') || voices.find(voice => voice.lang === 'zh-TW');
      voicesLoaded = true;
    }

    function speak(text, lang) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = lang;
      if (lang === 'ja-JP' && jpVoice) {
        utterance.voice = jpVoice;
      } else if ((lang === 'zh-CN' || lang === 'zh-TW') && cnVoice) {
        utterance.voice = cnVoice;
      }
      speechSynthesis.speak(utterance);
    }

    function autoPlayNext() {
      if (!autoPlay) return;
      
      const row = vocabRows[currentIndex];
      const jpText = row.querySelector('.jp').textContent.trim();
      const cnText = row.querySelector('.cn').textContent.trim();

      // 先念日文，再念中文
      speak(jpText, 'ja-JP');
      setTimeout(() => speak(cnText, 'zh-CN'), 1500); // 中文延遲 1.5 秒

      // 下一個單字
      currentIndex = (currentIndex + 1) % vocabRows.length;
      setTimeout(autoPlayNext, 4000); // 每組日中朗讀間隔 4 秒
    }

    function toggleAutoPlay() {
      autoPlay = !autoPlay;
      const btn = document.getElementById('autoplay-btn');
      if (autoPlay) {
        btn.textContent = '⏹️ 停止自動播放';
        currentIndex = 0;
        autoPlayNext();
      } else {
        btn.textContent = '🔊 自動播放';
        speechSynthesis.cancel();
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      initVoices();
      vocabRows = Array.from(document.querySelectorAll('tr')).slice(1); // 跳過表頭

      // 自動播放按鈕
      document.getElementById('autoplay-btn').addEventListener('click', toggleAutoPlay);

      // 點擊單字或中文播放
      document.querySelectorAll('.jp, .cn').forEach(element => {
        element.addEventListener('click', () => {
          const text = element.textContent.trim();
          const lang = element.classList.contains('jp') ? 'ja-JP' : 'zh-CN';
          speak(text, lang);
        });
      });
    });
  </script>
</body>
</html>


